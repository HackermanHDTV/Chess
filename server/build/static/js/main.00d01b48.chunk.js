(this.webpackJsonpsockets=this.webpackJsonpsockets||[]).push([[0],{124:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),c=n(62),i=n.n(c),o=n(4),r=n(5),l=(n(69),n(3)),u=n(19),A=n.n(u),j=n(0);n(31).config();var d=s.a.createContext();function b(){return Object(a.useContext)(d)}function v(e){var t=e.children,n=Object(a.useState)(),s=Object(l.a)(n,2),c=s[0],i=s[1],o=Object(r.g)();Object(a.useEffect)((function(){var e=localStorage.getItem("userid");e&&"undefined"!==e&&"null"!==e&&""!==e&&A()({method:"GET",params:{id:e},url:"".concat("","/api/user")}).then((function(e){i(e.data),o.push("/")})).catch((function(e){return console.error(e)}))}),[o]);var u={user:c,setLocalUser:function(e){i(e),localStorage.setItem("userid",e._id)},logout:function(){i(),localStorage.setItem("userid","")}};return Object(j.jsx)(d.Provider,{value:u,children:t})}var p=n.p+"static/media/user.a296afc6.svg",f=n.p+"static/media/lock.659e94a4.svg";function O(){var e=Object(a.useRef)(),t=Object(a.useRef)(),n=Object(a.useState)(""),s=Object(l.a)(n,2),c=s[0],i=s[1],u=Object(a.useState)(!1),d=Object(l.a)(u,2),v=d[0],O=d[1],m=b().setLocalUser,h=Object(r.g)();return Object(a.useEffect)((function(){e.current.focus()}),[]),Object(j.jsx)("div",{className:"login-form",children:Object(j.jsxs)("form",{onSubmit:function(n){n.preventDefault(),O(!0),A()({method:"POST",url:"".concat("","/api/login"),data:{username:e.current.value,password:t.current.value}}).then((function(e){m(e.data),h.push("/")})).catch((function(n){i("Could not log in"),e.current.value="",t.current.value="",O(!1),console.error(n)}))},children:[Object(j.jsx)("span",{children:"Log In"}),c&&Object(j.jsx)("div",{className:"error",children:c}),Object(j.jsxs)("div",{className:"input-cont",children:[Object(j.jsx)("img",{src:p,alt:""}),Object(j.jsx)("input",{ref:e,placeholder:"Username",required:!0})]}),Object(j.jsxs)("div",{className:"input-cont",children:[Object(j.jsx)("img",{src:f,alt:""}),Object(j.jsx)("input",{type:"password",ref:t,placeholder:"Password",required:!0})]}),Object(j.jsx)("button",{disabled:v,type:"submit",children:"Log In"}),Object(j.jsxs)("div",{className:"prompt",children:["Don't have an account?",Object(j.jsx)(o.b,{to:"/signup",children:" Sign up"})]})]})})}function m(){var e=Object(a.useRef)(),t=Object(a.useRef)(),n=Object(a.useRef)(),s=Object(a.useState)(""),c=Object(l.a)(s,2),i=c[0],u=c[1],d=Object(a.useState)(!1),v=Object(l.a)(d,2),O=v[0],m=v[1],h=b().setLocalUser,g=Object(r.g)();return Object(a.useEffect)((function(){e.current.focus()}),[]),Object(j.jsx)("div",{className:"signup-form",children:Object(j.jsxs)("form",{onSubmit:function(a){if(a.preventDefault(),m(!0),t.current.value!==n.current.value)return u("Passwords don't match"),void m(!1);A()({method:"POST",url:"".concat("","/api/signup"),data:{username:e.current.value,password:t.current.value}}).then((function(e){h(e.data),g.push("/")})).catch((function(a){u("Could not sign up"),e.current.value="",t.current.value="",n.current.value="",console.error(a),m(!1)}))},children:[Object(j.jsx)("span",{children:"Sign Up"}),i&&Object(j.jsx)("div",{className:"error",children:i}),Object(j.jsxs)("div",{className:"input-cont",children:[Object(j.jsx)("img",{src:p,alt:""}),Object(j.jsx)("input",{ref:e,placeholder:"Username",required:!0})]}),Object(j.jsxs)("div",{className:"input-cont",children:[Object(j.jsx)("img",{src:f,alt:""}),Object(j.jsx)("input",{type:"password",ref:t,placeholder:"Password",required:!0})]}),Object(j.jsxs)("div",{className:"input-cont",children:[Object(j.jsx)("img",{src:f,alt:""}),Object(j.jsx)("input",{type:"password",ref:n,placeholder:"Confirm Password",required:!0})]}),Object(j.jsx)("button",{disabled:O,type:"submit",children:"Sign Up"}),Object(j.jsxs)("div",{className:"prompt",children:["Already have an account?",Object(j.jsx)(o.b,{to:"/login",children:" Log In"})]})]})})}function h(){var e=b().user;return Object(j.jsxs)("div",{className:"dashboard",children:[Object(j.jsx)("div",{children:e?Object(j.jsxs)("p",{children:[" ","Hi, ".concat(e.username),"! "]}):Object(j.jsx)("p",{children:"You are not Logged in"})}),e&&Object(j.jsxs)("div",{className:"prompt",children:["Play a game? ",Object(j.jsx)(o.b,{to:"/play-online",children:"Play Online"})]})]})}n(31).config(),n(31).config();var g=n(2),x=n(16);function y(){var e=b(),t=e.user,n=e.logout,s=Object(a.useState)(!1),c=Object(l.a)(s,2),i=c[0],r=c[1];return Object(j.jsx)("header",{className:"header",children:Object(j.jsxs)("nav",{className:"flex flex-ai-c flex-jc-sb",children:[Object(j.jsx)(o.b,{to:"/",children:Object(j.jsxs)("div",{className:"header__logo flex flex-ai-c",children:[Object(j.jsx)("img",{src:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBw0NDQ4NDQ0NDQ0NDg0NDQ0NDQ8NDQ0NFREWFhURFRUYHSgsGBolHRUVITEiJSkuLi8uFyI/ODMtNyg5LisBCgoKDg0OFxAPFSsdFR0rLSsrLS0tKysrLSstNy0rKy8rLS0tLSstKy0rLS0rListKy0rKystLisrKystKysrL//AABEIAOEA4QMBEQACEQEDEQH/xAAcAAEBAAIDAQEAAAAAAAAAAAAAAQIDBAUGBwj/xABGEAACAgACAwsGCgkFAQAAAAAAAQIDBBEFITEGEhNBUVNhcZKT0RUiUnORsSMyM2JygaGywdIHNEJDRFSUouEUJIKj8Bf/xAAbAQEBAAMBAQEAAAAAAAAAAAAAAQIDBAUGB//EADcRAQACAQEDCgQEBgMBAAAAAAABAgMRBDFRBRITFCFBUnGh0RUygZEiYbHwIyQzQsHhU2KSBv/aAAwDAQACEQMRAD8A+THc5wCgMwADMoZgMyABMwAUAgAABAIQAIAAAQgAAoBABBAAG8zQAAAgAAAAAUAAQAAAgEIAACACAUQgBQCACABAAG4zQAoAAAAAAIAAAAAEAgAgAQAAAhAABQCACCMAAA3GaAAAAAAAAAAAAgACEAAAAgACEAAFAIAIAEAAANpmigQABQAAAAAgAABCABAAAABCAACgRAoAIIwAAABsMkUAAKAAgFAAQQABsw1Fls1XVCdlktkIRcpP6lxdI01Y2tFY1tOkPVaP3A4qxKWItrwyeT3iXDWfXk0l7Wba4Zne8/Jynjr2UibekO0/+f4VJueKxCUVnKXwUIr+1mc4q1jW0uf4nkndWPVwLNyWDzyruxcvnSdUV9S3ngcl8lY3Qwnla8bqx6+6R3G0P99f/wBf5TRO0TwY/F8vgj1922O4nDv9/iPbV+UwnabcIT4xl8FfX3bFuGwz/f4n21flMZ2u3CD4xln+yvr7t1f6P8K/4jFe2r8hotyheP7Y9fdurynln+2PX3cmv9G+Ef8AEYv20/kOe3K2SP7Y9fd002y890erpd1G53RWjo714nGXYqSzhh4zo1ckrHvPNj9r4jfsm17VtE6xSsU49vp29rsx3tftmOx4w9ZuABAAgAAAINhmgAAAAAAAAAAdrud0FdpC3eQ8yqGTuuazjBci5ZPiRlWk2lz7TtNcFdZ7Z7o/fc+p6J0VhsDXweHhvc8t/Y9dlj5ZS4+rYjrrSI3Pnc2e+a2t59ocmdhsiGEQ6bTGJc7OCT8yp5P51nG31bDz899bflCXnuaK4nDaWmXJgjTMo3xRrmWLdVE03lnSNZc6mBxZLO7HV4/dTu6VW+w+AalYs42YnLOFb2NVr9p9OxdPF27Lybz9L5t3D3exs+zdmt3zqycpSlOcpSlJuUpSblKUntbb2s9uIiI0iNIdzAqhAAgAAAAEGZmgBQAABmAzAAANuDws77a6a1nZbJQiuLN8b6Frb6ixGs6QwveKVm1t0PsWicBVgsPDD1bIrOUn8ayb+NN9LO6lNI0fM5sts15vZunYbIhjENSs85da95np2M4h0liztm+Wyb/uZ4eWfxS5r75cmtHLaWtvgjVMo3RRrmUcqmJy5LOnHVz8PHWjhyWd+Or4NivlbfWWfeZ9dT5Y8oe/G6GkyUIAEAAAAAggGwzQAAAAAAAAAew/Rzg07rsTJfJRVdf05/GfWksv+R0bPXWZl5nKWTStaR39v2/fo91Ow7Yh5EQ0TsM4hnENPCa11oz0ZxDh5Zzk/nP3nzmafxW85cN98uTBHLMsG+CNUyxb64mq86QypGsubTE4slndjq5+HjrRw5LO/HV+fsX8rb62z77PtKfLHlD2I3NRVAIAAAABBAAGwyQKAAAAAAAAH0LcHFRwTa2zvsk/qUY/gd+yx+B4vKE65fKId7Ow64hyRDROwziGcQ1b/WusrOIeJq3RYjD32ptXVq63KE3rS371RlxfXmfP5scWtbzl35OT8WWsT8ttI7Y/zD1Wid0OFxOUVPgrH+7tyi2/mvY/ecOTFavk8baNgzYe3TWvGP3q72KOaZcLk0xObJZ0Y6ufTE4slnfjq5+HjrRw5LO/HV+d8Z8tb62377PuafLXyh6LUZKgAAAAEEAAAMzJAAAAAAAFAgHv9xs8sDH1lvvPU2SP4bx9tj+L9IdtOZ1xDmiGqUytkVaXZrDZFXzrFvO218tlj/uZ4N/mnzexT5Y8mpmLJ3u5/TWka5KvDuWIgttNqc60vpfse3I5doph01vPN/P972uOSo2y3Nx49bfl/nu+76Xo7SNc4x4ZKixrzlvnZUn0TyX2o8LJaJn8M6w27R/8htuCvOx6X/KN8fSd/wBNXe016k9Ti9kk84vqZxZJePGG+O3NvGkxxc6iGtHBks7MdX5wxny1vrbfvs/QMfyV8odbSZAAAACCAABACszNAAAABAAACgHuNyUssHH1lnvPW2P+n9XlbXH8X6Q7WczqaIq0zsDbFWiVhW2KvA2vOUnyyk/tPn7T2y9GNzAg99uQxld+H4JRjCynJTjFKKmuKzVy8fT1nzfKWO+LLzpnWtt3t++59ryLtlMmDo4iItXfp2a/n7/m710nn9K9mLt+BxNuHlnXLV+1B64S61+Im0Wjtcu2bHg2uumaus9098fX/G57DROLrxEd9Bb2UWlZW3m4PlT40+U87aK83t7nxO28mX2PJpPbSd0/vvfnLG/LXeut++z9Bx/JXyhxS0mYAABBAAAARQDMzQAAAAAAACAV7LcvLLCL6dnvPW2P+l9ZedtMa5HYzsOphFXHstyK21o407HJ5LNt6klrbZjMxEazudOPFNpitY1mWjQ+gY1ZWX5St2qG2Fb6eV/Z7z5uba7n23JnIlcWmXaI1v3R3R58Z9Iddum0dwc+HgvMsfnpbI2f595lWXncubB0WTp6R+G2/wDKf9/q67RePnhboX17YPXHPJTg9sX1mvaMFc+Ocdt0+k8Xj7NtFsGSMlN8escH1rAXV4mmF9T30LI5rlXLF9KeaPh81b4ck4774fb4dorlpF6z2S2ukwjK289ydF2ui+Fi2ZqM1y1t61+PWkL2i1ZiWjascZ8Vsc/Tz7nxLHL4e711332ffY/kr5R+j4Od7SZgAIIAAACKAQDMzQAAAAAAAAAer3Ozywq+nP3nrbH/AEvrLjzV1u5ll/IdS1o1VwnbLewWb2t8UVyt8SNeTLXHXnWnsduy7Jk2i8UxV1n9PN2VGHjUtXnSfxp8b6FyI8XaNptmnTdXg+75O5KxbHHO+bJ3z7cGbZoiHpTLViaY2wlXNZxksmvx6zKIc2fHTNScd41rLwmOwsqLJVy2x2PilHiaMnwG07PbZ8s47d3rHF6HcJp5YW//AE90ssPiJJJvZVc9Sl0J7H9R43LOwdPj6Skfjr6x/rfH2dvJm2dDfmWn8FvSX1J0dB8Xz30vPY8B0F57KLvheK+Vs9ZZ95n6Tj+SvlD4bJ88+ctRmxCCAAAAigEAEGZmgAAAAAAAAA9DoWeWHS+dP3nr7H/S+stdq6y7PB4Sdzz+LWvjTezqXKy7RtNcMdvbbg9Lk/kzJtduzsp3z7cZ/TvdpGMYR3layjx+lJ8rZ4uTLbLbnWl91smyYtlpzMce8+aMxiG+ZRsyiGqZYsziGuZdVp/R/D176K+FrzcfnR44/wDvxLo8flXY+sY+dWPx13fnHfHs8eYvkHLWk8V/NYn+ot8TT1bB/wAdf/Mezd0+Xxz9zyniv5rFf1FviTq2D/jr/wCY9jrGXxz93Ebz1vW3rb5Tc1AEAAABFAIAIAVkZsQCgAAAAAAAes3L6PVlCtseVSnJKKfnTeezoR0V2vosXMr836Pb5K5J61/EyfJw759o9XfznqSSUYx1RitSSOGZm06z2y+0x4646xWsaRDW2ZRBMo2ZRDVMsTOIa5lGZRDVMsczOIa5l5XdFo/g58LBeZY9fJGf+dvtMLV07Xy/Kmy9HfpKx+G3pP8At05g8oIIAAACKAAIAIAVCDM2MQAAAAAAAAB7Pcu/9pFfPsy9prtvfc8gz/Jx5y7VsRD1ZlGzKIa5liZxDXMo2ZRDVMsWZxDXMoZRDXMtWJpjbCVc1nGSyfR0rpLzdYc+alclJpbdLxGLw8qbJVy2xe3ikuJo5pjSdHyebDbFeaW7mkjUAABFAAEAEUAhAAzNjEAAAAAAAAAey3L/AKqvp2e8wne+25Dn+Tjzl2jZYh6kyjZnDVMo2ZRDXMsWZxDXMoZRDXMo2ZRDXMsWZRDXMur07gOGr38V8JWm1yyjxx8P8mGWmsaxvebt+z9LTnR80fo8ocrwAigACACAFQAQAAVmZsAoAAAAAAAAew3Mfqq+nZ7yaPs+RJ/lI85dqzKIelMo2ZRDXMsWzOIa5lGZRDXMo2ZRDXMsTKIa5lDLRrmUMohrmXl9PYHgp8JFfB2PXyRnxr69vtOTPj5s6xul4m2YOZbnRun9XVGhxAEAEAKhAABQgAZGxgAAAAAAAAAOdhNLYimG8rmlHNvJwi9b6w7sHKO0YKczHbSvlDb5fxfOR7uHgXVt+L7X4o+0Hl7Fc5Hu4+A50p8V2rxR9oTy7iucj3cfAvPlj8U2nxR9oPLuK9OPdx8C9JZPie0+L0g8uYrnI9iI6S3FPiO0eL0hPLmK9OPYiOltxT4hn8XpB5bxXprsR8C9Nfidez8fRPLeJ9NdiPgOnvxTrubj6Nd+lL7IuE5RcZbVvIktmtaNJYX2nJeNLT2eThGtzhACgEIAAKEACAZmxgAAAAAAAAbcLhp3TVdazk/YlyvkRa1m06QzpSbzpXe9dDRVEIRjwVcnFJOUoRcpPjbPUphpERE1ifo9C2CsVjSNzB4Gjmau7j4G3ocfhj7Ofm14I8FRzNXdx8B0GPwx9oY82OCPBUczV3cfAvQY/BH2hJiODH/RUczV3cfAvQY/BH2hjpHBHg6OZq7uPgOgx+CPtDGdGDwdPM1d3HwHQYvBH2hjLF4Snmq+xEvQYvBH2hixeFp5qvsRHQYvBH2hjMsXhauar7ER0GLwR9oSZl0uOwzqk/Qb81/geRtOCcVv+s7mdZ1cY52SEAAAChAAhFAMzYwAAAAAAypjvpxjsUpRj7XkWO2dFrGsxD1MNzWHT86dsujOMV9iO6Nlr3zL0ep443zMuyw+Grpjva4KC48tr63xnTSlaxpWG6ta0jSsaM2zNjMtNi4zOJc9474amzNplGGOrFsrGZYNhhMsWysZlg2GMyxbDGZYtlYzLCaTWTSae1PWiWrFo0mNYY6uFZo2p7N9Hqea+047bBindrDLpZh1eIrUJyitaTyzZ5WanMvNY7m+s6xq1mtkEAAQQKAMwMjYwAKBAGYFAzomlODeyM4t9SaLWdJhlWdJiXrXp/Cc4+7s8D0es4+PpL0p2nHxYvTuF5x93Z4F61i4+ksJ2inFi9OYXnH3c/AvWsXH0lhOenFi9N4bnH3c/AvW8XH0lhOWvFrlpjDcU33c/AyjbMPH0lqtaO5i9L4f032J+BeuYePpLCbMXpbD+m+xPwHXMPH0ljqxelaPTfYn4DruHj6SjF6Uo9N9iXgXruHj6Sx0lHpOj032JeA67h8XpKc2WL0lT6T7MvAddw+L0ljzJR6Rp9J9mXgOvYfF6SnMsnlCn0n2ZeA67h8XpPsnR2Y+UKvSfZl4F69g8XpPsnRW4OrxU1KyUlrTeri4jyM94vktau6XRSNKxEtRpZAEIoAAhAAzNjECAAAAAAAAAAFAAACEAAAABQgAAIQAoAAhAAZkGRsYhQzAZgAAAAAAEAAAAAAAUAEAABCAFAAEAEAARQDI2MAAAAAAAAAAAAAoAAEAAAAhACgDMAQAIAIAUIAGRsYgAAUAAAAQAAAAAAAAIQAoAAZgCCAAGZACgAgAAMjNiAAAAoAAAAABABFAAAAAzAAQgoEAZkAKACAAAAAKZoAAAAAAAFAgAAAAAAAgACkEAACCBVIoEQCgAAAK/9k=",alt:""}),Object(j.jsx)("div",{className:"text",children:"Chess"})]})}),i&&Object(j.jsx)("div",{className:"header__dropdown",children:Object(j.jsx)("ul",{children:Object(j.jsxs)("ul",{className:"dropdown__links hide-for-desktop",children:[Object(j.jsx)(o.b,{to:"/play-online",children:Object(j.jsx)("li",{children:"Play Online"})}),Object(j.jsx)(o.b,{to:"/play-local",children:Object(j.jsx)("li",{children:"Pass & Play"})}),Object(j.jsx)(o.b,{to:"/analysis",children:Object(j.jsx)("li",{children:"Analysis Board"})}),Object(j.jsx)(o.b,{to:"/profile",children:Object(j.jsx)("li",{children:"Profile"})})]})})}),Object(j.jsxs)("div",{className:"header__menu hide-for-desktop",onClick:function(){return r(!i)},children:[Object(j.jsx)("span",{}),Object(j.jsx)("span",{}),Object(j.jsx)("span",{})]}),Object(j.jsxs)("ul",{className:"header__links hide-for-mobile flex flex-jc-sb flex-ai-c",children:[Object(j.jsx)(o.b,{to:"/play-online",children:Object(j.jsx)("li",{children:"Play Online"})}),Object(j.jsx)(o.b,{to:"/play-local",children:Object(j.jsx)("li",{children:"Pass & Play"})}),Object(j.jsx)(o.b,{to:"/analysis",children:Object(j.jsx)("li",{children:"Analysis Board"})}),Object(j.jsx)(o.b,{to:"/profile",children:Object(j.jsx)("li",{children:"Profile"})})]}),t?Object(j.jsx)("div",{onClick:function(){return n()},className:"header__button hide-for-mobile",children:"Log Out"}):Object(j.jsx)("div",{className:"header__button hide-for-mobile",children:Object(j.jsx)(o.b,{to:"/login",children:"Log In"})})]})})}var C=["component"];function E(e){var t=e.component,n=Object(x.a)(e,C),a=b().user;return Object(j.jsx)(r.b,Object(g.a)(Object(g.a)({},n),{},{render:function(e){return a?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(y,{}),Object(j.jsx)(t,Object(g.a)({},e))]}):Object(j.jsx)(r.a,{to:"/login"})}}))}var w=["component"];function P(e){var t=e.component,n=Object(x.a)(e,w),a=b().user;return Object(j.jsx)(r.b,Object(g.a)(Object(g.a)({},n),{},{render:function(e){return a?Object(j.jsx)(r.a,{to:"/login"}):Object(j.jsx)(t,Object(g.a)({},e))}}))}var M=["component"];function N(e){var t=e.component,n=Object(x.a)(e,M);return Object(j.jsx)(r.b,Object(g.a)(Object(g.a)({},n),{},{render:function(e){return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(y,{}),Object(j.jsx)(t,Object(g.a)({},e))]})}}))}var R=n(28);function L(e,t,n){return!!function(e,t){return""===function(e,t){return n[t][e]}(e,t)}(e,t)}function F(e,t,n,a){function s(e,t){return a[t][e]}return!(function(e,t){return""===s(e,t)}(e,t)||!function(e,t,n){return function(e,t){var n=s(e,t);return n===n.toLowerCase()?"b":n===n.toUpperCase()?"w":void 0}(e,t)!==n}(e,t,n))}function S(e,t){return"".concat(["a","b","c","d","e","f","g","h"][e]).concat(8-t)}function k(e){return[e.charCodeAt(0)-97,8-parseInt(e.charAt(1))]}function I(e,t,n){var a,s=k(e),c=Object(l.a)(s,2),i=c[0],o=c[1],r=[],u=function(e,n){var a=function(e,n){return t[n][e]}(e,n);return a===a.toLowerCase()?"b":a===a.toUpperCase()?"w":void 0}(i,o);("w"===u?(o>0&&L(i,o-1,t)&&(r.push({move:[e,S(i,o-1)],isCapture:!1,isCastle:!1,isEnPassant:!1,piece:"P",isPawnMove:!0}),6===o&&L(i,4,t)&&(i>0&&F(i-1,4,"w",t)||i<7&&F(i+1,4,"w",t)?r.push({move:[e,S(i,4)],isCapture:!1,isCastle:!1,isEnPassant:!1,piece:"P",isPawnMove:!0,newEnPassantSquare:S(i,5)}):r.push({move:[e,S(i,4)],isCapture:!1,isCastle:!1,isEnPassant:!1,piece:"P",isPawnMove:!0}))),i<7&&o>0&&F(i+1,o-1,u,t)&&r.push({move:[e,S(i+1,o-1)],isCapture:!0,isCastle:!1,isEnPassant:!1,piece:"P",isPawnMove:!0}),i>0&&o>0&&F(i-1,o-1,u,t)&&r.push({move:[e,S(i-1,o-1)],isCapture:!0,isCastle:!1,isEnPassant:!1,piece:"P",isPawnMove:!0})):(o>0&&L(i,o+1,t)&&(r.push({move:[e,S(i,o+1)],isCapture:!1,isCastle:!1,isEnPassant:!1,piece:"p",isPawnMove:!0}),1===o&&L(i,3,t)&&(i>0&&F(i-1,3,"b",t)||i<7&&F(i+1,3,"b",t)?r.push({move:[e,S(i,3)],isCapture:!1,isCastle:!1,isEnPassant:!1,piece:"p",isPawnMove:!0,newEnPassantSquare:S(i,2)}):r.push({move:[e,S(i,3)],isCapture:!1,isCastle:!1,isEnPassant:!1,piece:"p",isPawnMove:!0}))),i>0&&o<7&&F(i-1,o+1,u,t)&&r.push({move:[e,S(i-1,o+1)],isCapture:!0,isCastle:!1,isEnPassant:!1,piece:"p",isPawnMove:!0}),i<7&&o<7&&F(i+1,o+1,u,t)&&r.push({move:[e,S(i+1,o+1)],isCapture:!0,isCastle:!1,isEnPassant:!1,piece:"p",isPawnMove:!0})),"-"!==n)&&(1===Math.abs(i-k(n)[0])&&(2===k(n)[1]&&(a=S(k(n)[0],3)),5===k(n)[1]&&(a=S(k(n)[0],4)),r.push({move:[e,n],isCastle:!1,isCapture:!0,isEnPassant:!0,enPassantSquare:n,enPassantCapture:a,piece:"w"===u?"P":"p",isPawnMove:!0})));return r}function z(e,t){for(var n=e.move,a=[],s=0;s<8;s++){a.push([]);for(var c=0;c<8;c++)a[s].push(t[s][c])}var i=k(n[1]),o=Object(l.a)(i,2),r=o[0],u=o[1],A=k(n[0]),j=Object(l.a)(A,2),d=j[0],b=j[1];if(e.isEnPassant){var v=k(e.enPassantCapture),p=Object(l.a)(v,2),f=p[0],O=p[1];a[u][r]=t[b][d],a[b][d]="",a[O][f]=""}else e.isCastle?("O-O"===e.castleType&&("w"===e.castleColor&&(a[7][5]="R",a[7][7]=""),"b"===e.castleColor&&(a[0][5]="r",a[0][7]="")),"O-O-O"===e.castleType&&("w"===e.castleColor&&(a[7][3]="R",a[7][0]=""),"b"===e.castleColor&&(a[0][3]="r",a[0][0]="")),a[u][r]=t[b][d],a[b][d]=""):(a[u][r]=t[b][d],a[b][d]="");return a}function Z(e,t){var n,a="w"===e?"K":"k",s=t.findIndex((function(e){return e.includes(a)})),c=null===(n=t[s])||void 0===n?void 0:n.indexOf(a);if("w"===e){if(B(c+1,s-1)&&"p"===m(c+1,s-1))return!0;if(B(c-1,s-1)&&"p"===m(c-1,s-1))return!0}else{if(B(c-1,s+1)&&"P"===m(c-1,s+1))return!0;if(B(c+1,s+1)&&"P"===m(c+1,s+1))return!0}var i=!1,o="w"===e?["b","q"]:["B","Q"];if([[1,1],[1,-1],[-1,1],[-1,-1]].forEach((function(e){h(c,s,e[0],e[1],o)||(i=!0)})),!i){var r="w"===e?["r","q"]:["R","Q"];[[1,0],[-1,0],[0,1],[0,-1]].forEach((function(e){h(c,s,e[0],e[1],r)||(i=!0)}))}if(!i)for(var l=[[2,1],[2,-1],[1,2],[1,-2],[-1,2],[-1,-2],[-2,1],[-2,-1]],u="w"===e?"n":"N",A=0;A<8;A++){var j=c+l[A][0],d=s+l[A][1];if(B(j,d)&&m(j,d)===u){i=!0;break}}if(!i)for(var b=[[1,1],[0,1],[-1,1],[1,0],[-1,0],[1,-1],[0,-1],[-1,-1]],v="w"===e?"k":"K",p=0;p<8;p++){var f=c+b[p][0],O=s+b[p][1];if(B(f,O)&&m(f,O)===v){i=!0;break}}return i;function m(e,n){return t[n][e]}function h(e,t,n,a,s){for(var c=e+n,i=t+a;B(c,i);){if(s.includes(m(c,i)))return!1;if(""!==m(c,i))return!0;c+=n,i+=a}return!0}}function B(e,t){return e>=0&&e<=7&&t>=0&&t<=7}function D(e,t,n){return Z(t,z(e,n))}function X(e,t){function n(e,t){return e>=0&&e<=7&&t>=0&&t<=7}function a(e,n){var a=function(e,n){return t[n][e]}(e,n);return a===a.toLowerCase()?"b":a===a.toUpperCase()?"w":void 0}for(var s=k(e),c=Object(l.a)(s,2),i=c[0],o=c[1],r=[],u=[[2,1],[2,-1],[1,2],[1,-2],[-1,2],[-1,-2],[-2,1],[-2,-1]],A=0;A<8;A++){var j=i+u[A][0],d=o+u[A][1];n(j,d)&&(L(j,d,t)&&r.push({move:[e,S(j,d)],isCapture:!1,isCastle:!1,isEnPassant:!1,piece:"w"===a(i,o)?"N":"n"}),F(j,d,a(i,o),t)&&r.push({move:[e,S(j,d)],isCapture:!0,isCastle:!1,isEnPassant:!1,piece:"w"===a(i,o)?"N":"n"}))}return r}function Q(e,t){return e>=0&&e<=7&&t>=0&&t<=7}function H(e,t,n,a,s,c){function i(e,t){return c[t][e]}for(var o=e+n,r=t+a,l=[];Q(o,r);){if(!L(o,r,c)){if(F(o,r,s,c)){l.push({move:[S(e,t),S(o,r)],isCapture:!0,isEnPassant:!1,isCastle:!1,piece:i(e,t)});break}break}l.push({move:[S(e,t),S(o,r)],isCapture:!1,isEnPassant:!1,isCastle:!1,piece:i(e,t)}),o+=n,r+=a}return l}function T(e,t){function n(e,n){var a=function(e,n){return t[n][e]}(e,n);return a===a.toLowerCase()?"b":a===a.toUpperCase()?"w":void 0}var a=k(e),s=Object(l.a)(a,2),c=s[0],i=s[1],o=[];return[[1,1],[-1,1],[1,-1],[-1,-1]].forEach((function(e){o=o.concat(H(c,i,e[0],e[1],n(c,i),t))})),o}function G(e,t){function n(e,n){var a=function(e,n){return t[n][e]}(e,n);return a===a.toLowerCase()?"b":a===a.toUpperCase()?"w":void 0}var a=k(e),s=Object(l.a)(a,2),c=s[0],i=s[1],o=[];return[[1,0],[-1,0],[0,1],[0,-1]].forEach((function(e){o=o.concat(H(c,i,e[0],e[1],n(c,i),t))})),o}function K(e,t,n,a,s){return function(t){var s=k(t),c=Object(l.a)(s,2),i=[];switch(function(t,n){return e[n][t]}(c[0],c[1]).toLowerCase()){case"p":i=I(t,e,a);break;case"r":i=G(t,e);break;case"n":i=X(t,e);break;case"b":i=T(t,e);break;case"k":i=function(e,t,n){function a(e,t){return e>=0&&e<=7&&t>=0&&t<=7}function s(e,t){var n=c(e,t);return n===n.toLowerCase()?"b":n===n.toUpperCase()?"w":void 0}function c(e,n){return t[n][e]}for(var i=k(e),o=Object(l.a)(i,2),r=o[0],u=o[1],A=[],j=[[1,1],[0,1],[-1,1],[1,0],[-1,0],[1,-1],[0,-1],[-1,-1]],d="w"===s(r,u)?"K":"k",b="w"===s(r,u)?"Q":"q",v=0;v<8;v++){var p=r+j[v][0],f=u+j[v][1];a(p,f)&&(L(p,f,t)&&A.push({move:[e,S(p,f)],isCapture:!1,isCastle:!1,isEnPassant:!1,newCastlingRights:n.replace(d,"").replace(b,""),piece:d}),F(p,f,s(r,u),t)&&A.push({move:[e,S(p,f)],isCapture:!0,isCastle:!1,isEnPassant:!1,newCastlingRights:n.replace(d,"").replace(b,""),piece:d}))}return"K"===c(r,u)&&(n.includes("K")&&L(5,7,t)&&!D({move:["e1","f1"]},"w",t)&&L(6,7,t)&&!D({move:["e1","g1"]},"w",t)&&A.push({move:["e1","g1"],isCastle:!0,castleType:"O-O",castleColor:"w",newCastlingRights:n.replace("K","").replace("Q","")}),n.includes("Q")&&L(3,7,t)&&!D({move:["e1","d1"]},"w",t)&&L(2,7,t)&&!D({move:["e1","c1"]},"w",t)&&A.push({move:["e1","c1"],isCastle:!0,castleType:"O-O-O",castleColor:"w",newCastlingRights:n.replace("K","").replace("Q","")})),"k"===c(r,u)&&(n.includes("k")&&L(5,0,t)&&!D({move:["e8","f8"]},"b",t)&&L(6,0,t)&&!D({move:["e8","g8"]},"b",t)&&A.push({move:["e8","g8"],isCastle:!0,castleType:"O-O",castleColor:"b",newCastlingRights:n.replace("k","").replace("q","")}),n.includes("q")&&L(3,0,t)&&!D({move:["e8","d8"]},"b",t)&&L(2,0,t)&&!D({move:["e8","c8"]},"b",t)&&A.push({move:["e8","c8"],isCastle:!0,castleType:"O-O-O",castleColor:"b",newCastlingRights:n.replace("k","").replace("q","")})),A}(t,e,n);break;case"q":i=function(e,t){return T(e,t).concat(G(e,t))}(t,e);break;default:console.log("default case")}return i}(s).filter((function(n){return!D(n,t,e)}))}function W(e){return e.split(" ")[0].split("/").map((function(e){for(var t=[],n=0;n<e.length;n++)if(e[n]>=1&&e[n]<=8)for(var a=0;a<parseInt(e[n]);a++)t.push("");else t.push(e[n]);return t}))}function q(e){var t=e.split(" ");return{position:W(e),toMove:t[1],castlingRights:t[2],enPassantSquare:t[3],fiftyMoveRuleCount:parseInt(t[4]),moveCount:parseInt(t[5]),moves:[],legalMoveElements:[],selectedElement:null}}function Y(e){return"".concat(function(e){for(var t="",n=0;n<8;n++){for(var a=0,s=0;s<8;s++)""===e[n][s]?a++:(0!==a&&(t=t.concat(a),a=0),t=t.concat(e[n][s]));0!==a&&(t=t.concat(a)),7!==n&&(t=t.concat("/"))}return t}(e.position)," ").concat(e.toMove," ").concat(e.castlingRights," ").concat(e.enPassantSquare," ").concat(e.fiftyMoveCount," ").concat(e.moveCount)}function U(e){return e.isCastle?e.castleType:e.isEnPassant?"".concat(e.move[0].charAt(0),"x").concat(e.enPassantSquare):e.isPawnMove?e.isCapture?"".concat(e.move[0].charAt(0),"x").concat(e.move[1]):e.move[1]:e.isCapture?"".concat(e.piece,"x").concat(e.move[1]):"".concat(e.piece.toUpperCase()).concat(e.move[1])}var V=s.a.createContext(),J="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";function _(){return Object(a.useContext)(V)}var $=Object(g.a)(Object(g.a)({},q(J)),{},{legalMoveElements:[],highlightedElements:[],legalMoveObjects:[],selectedElement:null,moveList:[],displayedFEN:J,isLocal:!0,whiteTime:600,blackTime:600,FEN:J}),ee=Object(g.a)(Object(g.a)({},q(J)),{},{legalMoveElements:[],highlightedElements:[],legalMoveObjects:[],selectedElement:null,isOnline:!0,moveList:[],displayedFEN:J,FEN:J,played:!1,latestMoveObj:null}),te=Object(g.a)(Object(g.a)({},q(J)),{},{legalMoveElements:[],highlightedElements:[],legalMoveObjects:[],selectedElement:null,displayedFEN:J,moveList:[],isAnalysis:!0,FEN:J});function ne(e){var t=e.children;var n=Object(a.useReducer)((function(e,t){switch(t.type){case"init":return"local"===t.payload.type?Object(g.a)({},$):"online"===t.payload.type?Object(g.a)(Object(g.a)({},ee),{},{onlineColor:t.payload.onlineColor,emitMove:t.payload.emitMove}):"analysis"===t.payload.type?Object(g.a)({},te):e;case"select":if(t.payload.isBranch){var n=q(e.displayedFEN),a=K(n.position,n.toMove,n.castlingRights,n.enPassantSquare,S(t.payload.element.j,t.payload.element.i));return Object(g.a)(Object(g.a)({},e),{},{selectedElement:t.payload.element,legalMoveObjects:a,legalMoveElements:a.map((function(e){return e.move[1]})),highlightedElements:[],FEN:e.displayedFEN,position:n.position,castlingRights:n.castlingRights,enPassantSquare:n.enPassantSquare,toMove:n.toMove,fiftyMoveCount:n.fiftyMoveCount,moveCount:n.moveCount,moveList:e.displayedFEN===J?[]:e.moveList.slice(0,e.moveList.findIndex((function(t){return t.FEN===e.displayedFEN}))+1)})}var s=K(e.position,e.toMove,e.castlingRights,e.enPassantSquare,S(t.payload.element.j,t.payload.element.i));return Object(g.a)(Object(g.a)({},e),{},{selectedElement:t.payload.element,legalMoveObjects:s,legalMoveElements:s.map((function(e){return e.move[1]})),highlightedElements:[]});case"deselect":return Object(g.a)(Object(g.a)({},e),{},{legalMoveElements:[],legalMoveObjects:[],highlightedElements:[],selectedElement:null});case"highlight":return Object(g.a)(Object(g.a)({},e),{},{highlightedElements:[].concat(Object(R.a)(e.highlightedElements),[t.payload.id])});case"unhighlight":return Object(g.a)(Object(g.a)({},e),{},{highlightedElements:e.highlightedElements.filter((function(e){return e!==t.payload.id}))});case"show-previous":var c=e.moveList.findIndex((function(t){return t.FEN===e.displayedFEN}));return c>0?Object(g.a)(Object(g.a)({},e),{},{displayedFEN:e.moveList[c-1].FEN}):0===c?Object(g.a)(Object(g.a)({},e),{},{displayedFEN:J}):e;case"show-next":var i=e.moveList.findIndex((function(t){return t.FEN===e.displayedFEN}));return-1!==i&&i<e.moveList.length-1?Object(g.a)(Object(g.a)({},e),{},{displayedFEN:e.moveList[i+1].FEN}):e.displayedFEN===J?Object(g.a)(Object(g.a)({},e),{},{displayedFEN:e.moveList[0].FEN}):e;case"move":var o=z(t.payload.moveObj,e.position),r="w"===e.toMove?"b":"w",l="w"===e.toMove?e.moveCount+1:e.moveCount,u=t.payload.moveObj.isCapture||t.payload.moveObj.isPawnMove?e.fiftyMoveCount:e.fiftyMoveCount+1,A=t.payload.moveObj.newEnPassantSquare||"-",j=t.payload.moveObj.castlingRights||e.castlingRights,d=Y({position:o,toMove:r,moveCount:l,fiftyMoveCount:u,enPassantSquare:A,castlingRights:j});return Object(g.a)(Object(g.a)({},e),{},{FEN:d,position:o,highlightedElements:[],legalMoveElements:[],legalMoveObjects:[],selectedElement:null,castlingRights:j,enPassantSquare:A,moveCount:l,toMove:r,fiftyMoveCount:u,moveList:[].concat(Object(R.a)(e.moveList),[{move:U(t.payload.moveObj),FEN:d}]),displayedFEN:d,played:!0,latestMoveObj:t.payload.moveObj});case"receive-move":console.log("reducer recieve move");var b=z(t.payload.moveObj,e.position),v="w"===e.toMove?"b":"w",p="w"===e.toMove?e.moveCount+1:e.moveCount,f=t.payload.moveObj.isCapture||t.payload.moveObj.isPawnMove?e.fiftyMoveCount:e.fiftyMoveCount+1,O=t.payload.moveObj.newEnPassantSquare||"-",m=t.payload.moveObj.castlingRights||e.castlingRights,h=Y({position:b,toMove:v,moveCount:p,fiftyMoveCount:f,enPassantSquare:O,castlingRights:m});return Object(g.a)(Object(g.a)({},e),{},{FEN:h,position:b,highlightedElements:[],legalMoveElements:[],legalMoveObjects:[],selectedElement:null,castlingRights:m,enPassantSquare:O,moveCount:p,toMove:v,fiftyMoveCount:f,moveList:[].concat(Object(R.a)(e.moveList),[{move:U(t.payload.moveObj),FEN:h}]),displayedFEN:h});case"emitted":return Object(g.a)(Object(g.a)({},e),{},{played:!1});case"reset":return e.isLocal?Object(g.a)({},$):e.isOnline?Object(g.a)({},ee):e.isAnalysis?Object(g.a)({},te):e;default:return console.log("reducer default state"),console.log(t),e}}),{}),s=Object(l.a)(n,2),c={state:s[0],dispatch:s[1]};return Object(j.jsx)(V.Provider,{value:c,children:t})}var ae={p:n.p+"static/media/black-pawn.c9d3820c.svg",r:n.p+"static/media/black-rook.789e6d00.svg",n:n.p+"static/media/black-knight.f3a35b25.svg",b:n.p+"static/media/black-bishop.f234573a.svg",k:n.p+"static/media/black-king.f3deed09.svg",q:n.p+"static/media/black-queen.4dc242ad.svg",P:n.p+"static/media/white-pawn.8ef9ae1b.svg",R:n.p+"static/media/white-rook.c818fb9c.svg",N:n.p+"static/media/white-knight.da32ceb2.svg",B:n.p+"static/media/white-bishop.b3c514cb.svg",K:n.p+"static/media/white-king.ea20c759.svg",Q:n.p+"static/media/white-queen.11dddff4.svg"};function se(e){if(""!==e)return e===e.toLowerCase()?"b":e===e.toUpperCase()?"w":void 0}function ce(e){var t=e.piece,n=e.i,s=e.j,c=e.boardRef,i=S(s,n),o=_(),r=o.state,u=o.dispatch,A=Object(a.useRef)(),d=r.displayedFEN.split(" ")[1];var b=Object(a.useState)(!1),v=Object(l.a)(b,2),p=v[0],f=v[1],O=Object(a.useState)(),m=Object(l.a)(O,2),h=m[0],g=m[1];return Object(j.jsx)("img",{onContextMenu:function(e){e.preventDefault(),r.highlightedElements.includes(i)?u({type:"unhighlight",payload:{id:i}}):u({type:"highlight",payload:{id:i}})},id:t,src:"".concat(ae[t]),alt:"",style:{transform:"translate(".concat(s,"00%,").concat(n,"00%)")},onClick:function(){if(se(t)===d){if(r.onlineColor&&r.onlineColor!==d)return void console.log("not your move");u({type:"select",payload:{element:{piece:t,i:n,j:s},isBranch:r.FEN!==r.displayedFEN}})}else if(r.legalMoveElements.includes(i)){var e=r.legalMoveObjects.find((function(e){return e.move[0]===S(r.selectedElement.j,r.selectedElement.i)&&e.move[1]===i}));u({type:"move",payload:{moveObj:e}})}else u({type:"deselect"})},draggable:!1,onMouseDown:function(e){se(e.target.id)===d&&(e.target.classList.add("dragging"),r.onlineColor&&r.onlineColor!==d?console.log("not your move"):(u({type:"select",payload:{element:{piece:t,i:n,j:s},isBranch:r.FEN!==r.displayedFEN}}),f(!0),g(i)))},onMouseUp:function(e){var t=e.target;if(t.classList.remove("dragging"),p){f(!1);var n=document.elementsFromPoint(e.clientX,e.clientY).find((function(e){return e.classList.contains("square")}));if(n.classList.contains("legal")){t.style.transform=function(e){var t=k(e),n=Object(l.a)(t,2),a=n[0],s=n[1];return"translate(".concat(a*c.current.width/8,"px,").concat(s*c.current.width/8,"px)")}(n.id),g(n.id);var a=r.legalMoveObjects.find((function(e){return e.move[0]===S(r.selectedElement.j,r.selectedElement.i)&&e.move[1]===n.id}));u({type:"move",payload:{moveObj:a}})}else{var s=k(h),i=Object(l.a)(s,2),o=i[0],A=i[1];t.style.transform="translate(".concat(o,"00%,").concat(A,"00%)")}}},onMouseMove:function(e){var t=e.target,n=document.querySelector(".board"),a=n.offsetLeft,s=n.offsetTop;if(p){var c=e.clientX-a,i=e.clientY-s,o=c-A.current.width/2,r=i-A.current.width/2;t.style.transform="translate(".concat(o,"px,").concat(r,"px)")}},ref:A})}function ie(){var e=_(),t=e.dispatch,n=e.state,s=W(n.displayedFEN),c=Object(a.useRef)();return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("div",{className:"board",ref:c,children:[s.map((function(e,t){return e.map((function(e,n){if(e)return Object(j.jsx)(ce,{piece:e,i:t,j:n,boardRef:c},8*t+n)}))})),s.map((function(e,a){return e.map((function(e,s){var c=S(s,a);return Object(j.jsx)("div",{onContextMenu:function(e){e.preventDefault(),function(e){n.highlightedElements.includes(e)?t({type:"unhighlight",payload:{id:e}}):t({type:"highlight",payload:{id:e}})}(c)},onClick:function(){return function(e){if(n.legalMoveElements.includes(e)){var a=n.legalMoveObjects.find((function(t){return t.move[0]===S(n.selectedElement.j,n.selectedElement.i)&&t.move[1]===e}));t({type:"move",payload:{moveObj:a}})}else t({type:"deselect"})}(c)},id:c,className:"square ".concat((a+s)%2?"dark":"light"," ").concat(n.legalMoveElements.includes(c)?"legal":""," ").concat(n.highlightedElements.includes(c)?"highlighted":"")},8*a+s)}))}))]})})}function oe(e){var t=e.isAnalysis,n=_(),a=n.state,c=n.dispatch,i=a.moveList.map((function(e){return e.move}));return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("div",{className:"details hide-for-mobile",children:[Object(j.jsx)("span",{className:"top-border",children:"Moves"}),Object(j.jsx)("div",{className:"grid-cont",children:i.map((function(e,t){return t%2===0?Object(j.jsxs)(s.a.Fragment,{children:[Object(j.jsx)("p",{children:t/2+1}),Object(j.jsx)("button",{className:"move btn",children:e})]},t):Object(j.jsx)("button",{className:"move btn",children:e},t)}))}),t&&Object(j.jsxs)("div",{className:"controls flex flex-jc-c",children:[Object(j.jsxs)("div",{className:"btn forward flex flex-jc-c flex-ai-c",onClick:function(){c({type:"show-previous"})},children:[Object(j.jsx)("div",{className:"vertical-line"}),Object(j.jsx)("div",{className:"triangle-left"})]}),Object(j.jsxs)("div",{className:"btn backward flex flex-jc-c flex-ai-c",onClick:function(){c({type:"show-next"})},children:[Object(j.jsx)("div",{className:"triangle-right"}),Object(j.jsx)("div",{className:"vertical-line"})]})]})]})})}function re(e){var t=e.split(" "),n=function(e){return e.split("").reverse().join("").split("/").map((function(e){for(var t=[],n=0;n<e.length;n++)if(e[n]>=1&&e[n]<=8)for(var a=0;a<parseInt(e[n]);a++)t.push("");else t.push(e[n]);return t}))}(t[0]),a=t[1];var s=[];if(n.forEach((function(t,n){t.forEach((function(t,c){if(""!==t&&((r=t).toLowerCase()===r?"b":r.toUpperCase()===r?"w":void 0)===a){var i=q(e);s=s.concat(K(i.position,i.toMove,i.castlingRights,i.enPassantSquare,(o=n,"".concat(["a","b","c","d","e","f","g","h"][7-c]).concat(o+1))))}var o,r}))})),0===s.length)return Z(a,n)?"Checkmate":"Stalemate"}function le(){var e=_().state,t=Object(r.g)();return Object(a.useEffect)((function(){e.toMove&&("Checkmate"===re(e.FEN)&&(alert("".concat(e.toMove," won by checkmate")),t.push("/")),"Stalemate"===re(e.FEN)&&(alert("Draw by stalemate"),t.push("/")))}),[e.toMove]),Object(j.jsx)("div",{className:"online",children:e.onlineColor&&Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(ie,{}),Object(j.jsx)(oe,{isAnalysis:!1})]})})}var ue=n.p+"static/media/loading.83a9d0c8.svg";function Ae(){return Object(j.jsx)("div",{className:"loading",children:Object(j.jsx)("img",{src:ue,className:"App-logo",alt:"logo"})})}function je(e){var t=~~(e/3600),n=~~(e%3600/60),a=~~e%60,s="";return t>0&&(s+=t+":"+(n<10?"0":"")),s+=n+":"+(a<10?"0":""),s+=""+a}function de(e){var t=e.time;return Object(j.jsx)(j.Fragment,{children:je(t)})}function be(){var e=Object(a.useState)(!0),t=Object(l.a)(e,2),n=t[0],s=t[1],c=_(),i=c.dispatch,o=c.state,r=Object(a.useState)(),u=Object(l.a)(r,2),A=u[0],d=u[1],b=Object(a.useState)(),v=Object(l.a)(b,2),p=v[0],f=v[1],O=Object(a.useState)(600),m=Object(l.a)(O,2),h=m[0],g=m[1],x=Object(a.useState)(600),y=Object(l.a)(x,2),C=y[0],E=y[1];function w(){g((function(e){return e-1}))}function P(){E((function(e){return e-1}))}return Object(a.useEffect)((function(){return h<0||C<0?(alert("Black won by timeout"),E(600),g(600),void i({type:"reset"})):void 0}),[h,C]),Object(a.useEffect)((function(){o.FEN&&("Checkmate"===re(o.FEN)&&(alert("".concat(o.toMove," won by checkmate")),i({type:"reset"})),"Stalemate"===re(o.FEN)&&(alert("Draw by stalemate"),i({type:"reset"})),function(e){if("w"===e){var t=setInterval(w,1e3);d(t)}else{var n=setInterval(P,1e3);f(n)}}(o.toMove),"w"===("w"===o.toMove?"b":"w")?clearInterval(A):clearInterval(p))}),[o.toMove]),Object(a.useEffect)((function(){i({type:"init",payload:{type:"local"}}),s(!1)}),[]),Object(j.jsx)("div",{className:"local",children:n?Object(j.jsx)(Ae,{}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("div",{className:"local__board",children:[Object(j.jsx)("div",{className:"black time",children:Object(j.jsx)(de,{time:C})}),Object(j.jsx)(ie,{}),Object(j.jsx)("div",{className:"white time",children:Object(j.jsx)(de,{time:h})})]}),Object(j.jsx)(oe,{})]})})}function ve(){var e=Object(a.useState)(!0),t=Object(l.a)(e,2),n=t[0],s=t[1],c=_().dispatch;return Object(a.useEffect)((function(){c({type:"init",payload:{type:"analysis"}}),s(!1)}),[]),Object(j.jsx)("div",{className:"analysis",children:n?Object(j.jsx)(Ae,{}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(ie,{}),Object(j.jsx)(oe,{isAnalysis:!0})]})})}function pe(){var e=b().logout;return Object(j.jsx)(j.Fragment,{children:Object(j.jsx)("button",{onClick:function(){return e()},children:"Log Out"})})}var fe=n(64),Oe=n.n(fe),me=s.a.createContext();function he(e){var t=e.children,n=b().user,s=_(),c=s.dispatch,i=s.state,o=Object(a.useState)(),r=Object(l.a)(o,2),u=r[0],A=r[1],d=Object(a.useState)(),v=Object(l.a)(d,2),p=v[0],f=v[1],O=Object(a.useState)(!1),m=Object(l.a)(O,2),h=m[0],g=m[1];function x(e){console.log("emitting move to server..."),c({type:"emitted"}),null===u||void 0===u||u.emit("move",p,e)}Object(a.useEffect)((function(){i.played&&!0===i.played&&x(i.latestMoveObj)}),[i.played]),Object(a.useEffect)((function(){var e=Oe()("",{query:{id:n._id}});return A(e),e.emit("join-room"),g(!0),function(){return e.close()}}),[n]),Object(a.useEffect)((function(){u&&(u.on("init",(function(e,t){f(e),c({type:"init",payload:{type:"online",emitMove:x,onlineColor:t}})})),u.on("begin",(function(){g(!1)})),u.on("make-move",(function(e){console.log("socket receive move"),c({type:"receive-move",payload:{moveObj:e}})})))}),[u]);var y={playMove:x};return Object(j.jsx)(me.Provider,{value:y,children:h?Object(j.jsx)(Ae,{}):t})}var ge=["component"];function xe(e){var t=e.component,n=Object(x.a)(e,ge),a=b().user;return Object(j.jsx)(r.b,Object(g.a)(Object(g.a)({},n),{},{render:function(e){return a?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(y,{}),Object(j.jsx)(he,{children:Object(j.jsx)(t,Object(g.a)({},e))})]}):Object(j.jsx)(r.a,{to:"/login"})}}))}function ye(){return Object(j.jsx)(j.Fragment,{children:Object(j.jsx)(o.a,{children:Object(j.jsx)(r.d,{children:Object(j.jsxs)(v,{children:[Object(j.jsx)(P,{path:"/login",component:O}),Object(j.jsx)(P,{path:"/signup",component:m}),Object(j.jsx)(N,{path:"/",exact:!0,component:h}),Object(j.jsx)(E,{path:"/profile",exact:!0,component:pe}),Object(j.jsxs)(ne,{children:[Object(j.jsx)(xe,{path:"/play-online",component:le}),Object(j.jsx)(E,{path:"/play-local",component:be}),Object(j.jsx)(E,{path:"/analysis",component:ve})]})]})})})})}i.a.render(Object(j.jsx)(s.a.StrictMode,{children:Object(j.jsx)(ye,{})}),document.querySelector("#root"))},69:function(e,t,n){}},[[124,1,2]]]);
//# sourceMappingURL=main.00d01b48.chunk.js.map